package kafka

import org.apache.kafka.clients.consumer.{ConsumerConfig, ConsumerRecord}
import org.apache.pekko.actor.CoordinatedShutdown
import play.api.Logging
import play.api.libs.json.Json

import java.time.Duration
import java.util
import java.util.Properties
import javax.inject.{Inject, Singleton}

@Singleton
final class Consumer @Inject() (
    serverUrl: String,
    groupId: String,
    pollInterval: Duration,
    topics: List[String],
    actor: DatabaseActor,
    coordinatedShutdown: CoordinatedShutdown
) extends Logging {

  logger.info("Consumer starts")

  def module = Json.parse(
    "{\"metadata\":{\"id\":\"e37c5af9-6076-4f15-8c8b-d206b7091bc0\",\"title\":\"Paradigmen der Programmierung\",\"abbrev\":\"PP\",\"kind\":{\"id\":\"module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"ects\":{\"value\":5,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de\",\"deLabel\":\"Deutsch\",\"enLabel\":\"german\"},\"duration\":1,\"season\":{\"id\":\"ws_ss\",\"deLabel\":\"Winter- und Sommersemester\",\"enLabel\":\"winter and summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"ado\",\"lastname\":\"Dobrynin\",\"firstname\":\"Alexander\",\"title\":\"M.Sc.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"AD\",\"campusId\":\"adobryni\",\"status\":\"active\",\"kind\":\"person\"},{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[{\"id\":\"practical\",\"deLabel\":\"Praktikum\",\"enLabel\":\"--\"}]}],\"optional\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[]}]},\"workload\":{\"lecture\":36,\"seminar\":0,\"practical\":18,\"exercise\":18,\"projectSupervision\":0,\"projectWork\":0,\"selfStudy\":78,\"total\":150},\"prerequisites\":{\"recommended\":{\"text\":\"Grundlagen der Programmierung, Objektorientierte Programmierung\",\"modules\":[{\"id\":\"dca56fa6-1952-4b47-bf60-3dcb32e86ada\",\"title\":\"Algorithmen und Programmierung 1\",\"abbrev\":\"AP1\"},{\"id\":\"f1fd21a9-ab5c-40b0-ab09-3dff35e86a72\",\"title\":\"Algorithmen und Programmierung 2\",\"abbrev\":\"AP2\"}],\"pos\":[]}},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_inf1\",\"version\":1,\"program\":\"inf_inf\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf1_flex\",\"version\":1,\"program\":\"inf_inf_flex\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2026-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf2\",\"version\":2,\"program\":\"inf_inf\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_mi4\",\"version\":4,\"program\":\"inf_mi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2028-02-29\"},\"recommendedSemester\":[3]}],\"optional\":[{\"po\":{\"id\":\"inf_itm1\",\"version\":1,\"program\":\"inf_itm\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_itm2\",\"version\":2,\"program\":\"inf_itm\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi4\",\"version\":4,\"program\":\"inf_wi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]}]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"* (Was) Die Studierenden sollen unterschiedliche Programmierparadigmen verstehen und anwenden können. Weiterhin sollen sie die Angemessenheit der verschiedenen Programmierparadigmen für eine Aufgabenstellung einordnen und bewerten können. \\n* (Womit) Dies geschieht, indem verschieden Programmierparadigmen eingeführt und mithilfe einer dafür geeigneten Programmiersprache praktisch ausprobiert werden. Dabei wird vergleichend auf die verschiedenen Ansätze (prozedural, objektorientiert, funktional, logisch; deklarativ und imperativ; synchron und asynchron) eingegangen, indem Algorithmen in den verschiedenen Programmiersprachen umgesetzt werden. \\n* (Wozu) Studierende sollen mithilfe von etablierten Paradigmen in der Lage sein, verschiedene Denkweisen anzunehmen und Probleme auf unterschiedliche Weisen zu lösen.\",\"content\":\"* Vergleich imperativer und deklarativer Programmierstilen und Paradigmen\\n* Objektorientierte Design Prinzipien\\n* Objektorientierte Entwurfsmuster (Strategy, Decorator, Composite, Observer, Simple Factory)\\n* Funktionen, Lambdas und Closures\\n* Funktionen höherer Ordnung\\n* Currying und Funktionskomposition\\n* Kombinatoren wie zip, map, flatMap etc.\\n* Typentheorie und Algebraische Datentypen\\n* Parametrischer Polymorphismus\\n* Ausdruck von logischen Beziehungen\\n* Fakten, Regeln und Anfragen\\n* Variablen und Atome\\n* Unifikation und Variablenbindung\\n* Resolution und Backtracking\\n* Rekursive Prädikate\\n* Listen, Listenoperationen und Pattern Matching\\n* Nebenläufige Ausführung, Threads und Thread-Sicherheit\\n* Race Conditions und Dead Locks\\n* Synchroniksationsmechanismen\\n* Koroutinen, Aktoren und Flows\\n* Synchrone und asynchrone Programmiermodelle\",\"teachingAndLearningMethods\":\"* Vorlesung mit interaktiven Phasen, Präsentationen und Live-Coding\\n* Übung\\n* Praktikum\\n* Selbststudium mit bereitgestellten Screencasts, einem umfassenden Skript sowie Fachliteratur\\n\\n4 SWS: 2 SWS Vorlesung + 1 SWS Übung + 1 SWS Praktikum\",\"recommendedReading\":\"* Skript von Prof. Dr. Erich Ehses: www.gm.fh-koeln.de/ehses/paradigmen/\\n* Kohls, C., Dobrynin, A. (2022). Programmieren lernen mit Kotlin (Auflage 2). München: Hanser Verlag.\\n* Soshin, A. (2022). Kotlin Design Patterns and Best Practices - Second Edition. Packt Publishing.\\n* Gamma, E., Helm, R., Johnson, R., & Vlissides, J. (2015). Design patterns: Entwurfsmuster als Elemente wiederverwendbarer\\n* Freeman, E., Robson, E. (2015). Entwurfsmuster von Kopf bis Fuß. O’Reilly.\\n* Vermeulen, M., Bjarnason, R., Chiusano P (2021). Functional Programming in Kotlin. Manning Publications.\\n* W.F. Clocksin, C.S. Mellish (2003). Programming in Prolog. Springer Verlag.\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"* (WHAT)\\n* (HOW)\\n* (WHY)\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  def location = Json.parse(
    "{\"id\":\"other\",\"deLabel\":\"Sonstige / Variabel\",\"enLabel\":\"Other\"}"
  )

  def faculty = Json.parse(
    "{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}"
  )

  def degree = Json.parse(
    "{\"id\":\"bsc\",\"deLabel\":\"B.Sc.\",\"deDesc\":\"Bachelor of Science\",\"enLabel\":\"B.Sc.\",\"enDesc\":\"Bachelor of Science\"}"
  )

  def childModule = Json.parse(
    "{\"metadata\":{\"id\":\"05674322-071c-4a3a-8d8b-3c21c6bb640c\",\"title\":\"Informatik und Gesellschaft\",\"abbrev\":\"IUG\",\"kind\":{\"id\":\"module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"relation\":{\"kind\":\"child\",\"parent\":{\"id\":\"e3dc0278-cf5f-4296-a577-d88ad9c3e999\",\"title\":\"Informatik, Recht und Gesellschaft\",\"abbrev\":\"IRG\"}},\"ects\":{\"value\":3,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de\",\"deLabel\":\"Deutsch\",\"enLabel\":\"german\"},\"duration\":1,\"season\":{\"id\":\"ss\",\"deLabel\":\"Sommersemester\",\"enLabel\":\"summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"mwi\",\"lastname\":\"Winter\",\"firstname\":\"Mario\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"MW\",\"campusId\":\"mwinter\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"mwi\",\"lastname\":\"Winter\",\"firstname\":\"Mario\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"MW\",\"campusId\":\"mwinter\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[]}],\"optional\":[]},\"workload\":{\"lecture\":0,\"seminar\":0,\"practical\":0,\"exercise\":0,\"projectSupervision\":0,\"projectWork\":0,\"selfStudy\":90,\"total\":90},\"prerequisites\":{},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_inf2\",\"version\":2,\"program\":\"inf_inf\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_itm2\",\"version\":2,\"program\":\"inf_itm\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_mi4\",\"version\":4,\"program\":\"inf_mi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2028-02-29\"},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_wi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]}],\"optional\":[]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"\",\"content\":\"* Die Wechselwirkungen zwischen den von Informatikern entwickelten Systemen und ihrem Einsatzumfeld werden in drei großen Themenblöcken behandelt:\\n  * Informatik und soziale Kontexte\\n  * Komplexität und Sicherheit in sozio-technischenen Systemen\\n  * Systemgestaltung und Verantwortung der Informatik.\\n* Beispielhafte Inhalte: Geschichte der Informatik, Bildung und Wissenschaft, Wissenschaften und Gesellschaft, Digitale Medien und Internet, Datenschutz und Überwachungstechniken, Informatik und Gestaltung, partizipative Systemgestaltung, Open Source, Ethische Leitlinien für Informatiker, Normen und Standards, philosophische Aspekte der Informatik.\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"* Sara Baase: A Gift of Fire. Social, Legal, and Ethical Issues in Computing. Prentice Hall, Upper Saddle River, 1997\\n* A.F. Chalmers: Wege der Wissenschaft. 5. Aufl., Springer, Heidelberg, 2001\\n* D.M. Hester, P.J. Ford: Computers and Ethics in the Cyberage. Prentice Hall, Upper Saddle River, 2001\\n* P. Gola, C. Klug: Grundzüge des Datenschutzrechts. C.H. Beck, 2003\\n* M. Pierson, D. Seiler: Internet-Recht im Unternehmen. Beck-Rechtsberater im dtv, Deutscher Taschenbuch Verlag, München, 2002\\n* http://www.gi-ev.de Arbeitskreis Informatik und Verantwortung, Ethische Leitlinien der GI\\n* http://www.bfd.bund.de Der Bundesbeauftragte für den Datenschutz\\n* http://www.aktiv.org/DVD Deutsche Vereinigung für Datenschutz\\n* http://www.big-brother-award.org Überwachungsinformationen\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  def parentModule = Json.parse(
    "{\"metadata\":{\"id\":\"e3dc0278-cf5f-4296-a577-d88ad9c3e999\",\"title\":\"Informatik, Recht und Gesellschaft\",\"abbrev\":\"IRG\",\"kind\":{\"id\":\"module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"relation\":{\"kind\":\"parent\",\"children\":[{\"id\":\"05674322-071c-4a3a-8d8b-3c21c6bb640c\",\"title\":\"Informatik und Gesellschaft\",\"abbrev\":\"IUG\"},{\"id\":\"23ce931b-4d27-47da-9158-3ab8979759cf\",\"title\":\"Recht\",\"abbrev\":\"RE\"}]},\"ects\":{\"value\":5,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de\",\"deLabel\":\"Deutsch\",\"enLabel\":\"german\"},\"duration\":1,\"season\":{\"id\":\"ss\",\"deLabel\":\"Sommersemester\",\"enLabel\":\"summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"mwi\",\"lastname\":\"Winter\",\"firstname\":\"Mario\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"MW\",\"campusId\":\"mwinter\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"jhe\",\"lastname\":\"Henke\",\"firstname\":\"Julia-Isabell\",\"title\":\"--\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"JIH\",\"campusId\":\"jhenke1\",\"status\":\"active\",\"kind\":\"person\"},{\"id\":\"mwi\",\"lastname\":\"Winter\",\"firstname\":\"Mario\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"MW\",\"campusId\":\"mwinter\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"percentage\":60,\"precondition\":[]},{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"percentage\":40,\"precondition\":[]}],\"optional\":[]},\"workload\":{\"lecture\":72,\"seminar\":0,\"practical\":0,\"exercise\":0,\"projectSupervision\":0,\"projectWork\":0,\"selfStudy\":78,\"total\":150},\"prerequisites\":{},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_inf1\",\"version\":1,\"program\":\"inf_inf\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[5]},{\"po\":{\"id\":\"inf_inf2\",\"version\":2,\"program\":\"inf_inf\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_itm1\",\"version\":1,\"program\":\"inf_itm\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[5]},{\"po\":{\"id\":\"inf_itm2\",\"version\":2,\"program\":\"inf_itm\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_mi4\",\"version\":4,\"program\":\"inf_mi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2028-02-29\"},\"recommendedSemester\":[5]},{\"po\":{\"id\":\"inf_wi3\",\"version\":3,\"program\":\"inf_wi\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2021-02-28\"},\"recommendedSemester\":[5]},{\"po\":{\"id\":\"inf_wi4\",\"version\":4,\"program\":\"inf_wi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[5]},{\"po\":{\"id\":\"inf_wi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]}],\"optional\":[]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"(Was) Informatikerinnen und Informatiker analysieren und konstruieren sozio-technische Systeme und entwickeln dabei semiotische Artefakte wie z.B. Spezifikationen, Programme und Handbücher. Die entwickelten Systeme bilden einerseits soziale Wirklichkeit in vielfältiger Form ab und ändern andererseits diese Wirklichkeit durch ihren Einsatz.\\n\\n(Womit) Die Studierenden sollen befähigt werden,\\n\\n* die unterschiedlichen Wechselwirkungen zwischen Informatik-Systemen und ihrem Einsatzumfeld zu erkennen und zu bewerten,\\n* ethische und datenschutz-rechtliche Aspekte des Einsatzes von Informatik-Systemen zu charakterisieren,\\n* die Grundbegriffe des deutschen Privatrechts zu verstehen, und\\n* sich im dazugehörigen Gesetzeswerk zu orientieren,\\n\\n(Wozu) um ein kritisches Bewusstsein für die aktuellen Fragen des wechselseitigen Einflusses von Informatik und Gesellschaft zu entwickeln und insbesondere im Bereich des Vertragsrechts selbständige Lösungsvorschläge erarbeiten zu können.\",\"content\":\"Lehrveranstaltung Informatik und Gesellschaft (IUG, Ringveranstaltung geleitet von Prof. Dr. Mario Winter):\\n\\n* Die Wechselwirkungen zwischen den von Informatikern entwickelten Systemen und ihrem Einsatzumfeld werden in drei großen Themenblöcken behandelt:\\n  * Informatik und soziale Kontexte\\n  * Komplexität und Sicherheit in sozio-technischenen Systemen\\n  * Systemgestaltung und Verantwortung der Informatik.\\n* Beispielhafte Inhalte: Geschichte der Informatik, Bildung und Wissenschaft, Wissenschaften und Gesellschaft, Digitale Medien und Internet, Datenschutz und Überwachungstechniken, Informatik und Gestaltung, partizipative Systemgestaltung, Open Source, Ethische Leitlinien für Informatiker, Normen und Standards, philosophische Aspekte der Informatik.\\n\\nLehrveranstaltung Recht (RE, Dozent: Julia-Isabell Henke):\\n\\n* Einführung in das deutsche Privatrecht, insbesondere in das BGB.\\n* Schwerpunkt im Schuldrecht, hier insbesondere im Vertragsrecht.\\n* Besondere Aspekte des Verbraucherschutzes und der inhaltlichen Gestaltung von Verträgen.\\n* Im Allgemeinen Teil des BGB wird auf den Vertragsschluss, die Willenerklärung als rechtsgeschäftliches Gestaltungsmittel und die allgemeinen Anforderungen an die Vertragspartner eingegangen.\",\"teachingAndLearningMethods\":\"* Beamer-gestützte Vorlesungen (Folien in elektronischer Form im Netz)\\n* Vertiefende Unterlagen sowie aktuelle Artikel (in elektronischer Form im Netz)\\n* Seminar in Gruppenarbeit, um ausgewählte Themen zu vertiefen und zu präsentieren\",\"recommendedReading\":\"IuG:\\n\\n* Sara Baase: A Gift of Fire. Social, Legal, and Ethical Issues in Computing. Prentice Hall, Upper Saddle River, 1997\\n* A.F. Chalmers: Wege der Wissenschaft. 5. Aufl., Springer, Heidelberg, 2001\\n* D.M. Hester, P.J. Ford: Computers and Ethics in the Cyberage. Prentice Hall, Upper Saddle River, 2001\\n* P. Gola, C. Klug: Grundzüge des Datenschutzrechts. C.H. Beck, 2003\\n* M. Pierson, D. Seiler: Internet-Recht im Unternehmen. Beck-Rechtsberater im dtv, Deutscher Taschenbuch Verlag, München, 2002\\n* http://www.gi-ev.de Arbeitskreis Informatik und Verantwortung, Ethische Leitlinien der GI\\n* http://www.bfd.bund.de Der Bundesbeauftragte für den Datenschutz\\n* http://www.aktiv.org/DVD Deutsche Vereinigung für Datenschutz\\n* http://www.big-brother-award.org Überwachungsinformationen\\n\\nRecht:\\n\\n* Bürgerliches Gesetzbuch in der aktuellen Taschenbuchausgabe des dtv\\n* Fakultativ:\\n  * Eugen Klunziger, Einführung in das Bürgerliche Recht, Verlag Vahlen\\n  * Norbert Ullrich, Wirtschaftsrecht für Betriebswirte, Verlag Neue Wirtschaftsbriefe\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  def genericModule = Json.parse(
    "{\"metadata\":{\"id\":\"e37c5af9-6076-4f15-8c8b-d206b7091bc0\",\"title\":\"Paradigmen der Programmierung\",\"abbrev\":\"PP\",\"kind\":{\"id\":\"generic_module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"ects\":{\"value\":5,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de\",\"deLabel\":\"Deutsch\",\"enLabel\":\"german\"},\"duration\":1,\"season\":{\"id\":\"ws_ss\",\"deLabel\":\"Winter- und Sommersemester\",\"enLabel\":\"winter and summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"ado\",\"lastname\":\"Dobrynin\",\"firstname\":\"Alexander\",\"title\":\"M.Sc.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"AD\",\"campusId\":\"adobryni\",\"status\":\"active\",\"kind\":\"person\"},{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[{\"id\":\"practical\",\"deLabel\":\"Praktikum\",\"enLabel\":\"--\"}]}],\"optional\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[]}]},\"workload\":{\"lecture\":36,\"seminar\":0,\"practical\":18,\"exercise\":18,\"projectSupervision\":0,\"projectWork\":0,\"selfStudy\":78,\"total\":150},\"prerequisites\":{\"recommended\":{\"text\":\"Grundlagen der Programmierung, Objektorientierte Programmierung\",\"modules\":[{\"id\":\"dca56fa6-1952-4b47-bf60-3dcb32e86ada\",\"title\":\"Algorithmen und Programmierung 1\",\"abbrev\":\"AP1\"},{\"id\":\"f1fd21a9-ab5c-40b0-ab09-3dff35e86a72\",\"title\":\"Algorithmen und Programmierung 2\",\"abbrev\":\"AP2\"}],\"pos\":[]}},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_inf1\",\"version\":1,\"program\":\"inf_inf\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf1_flex\",\"version\":1,\"program\":\"inf_inf_flex\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2026-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf2\",\"version\":2,\"program\":\"inf_inf\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]},{\"po\":{\"id\":\"inf_mi4\",\"version\":4,\"program\":\"inf_mi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2028-02-29\"},\"recommendedSemester\":[3]}],\"optional\":[{\"po\":{\"id\":\"inf_itm1\",\"version\":1,\"program\":\"inf_itm\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_itm2\",\"version\":2,\"program\":\"inf_itm\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi4\",\"version\":4,\"program\":\"inf_wi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]}]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"* (Was) Die Studierenden sollen unterschiedliche Programmierparadigmen verstehen und anwenden können. Weiterhin sollen sie die Angemessenheit der verschiedenen Programmierparadigmen für eine Aufgabenstellung einordnen und bewerten können. \\n* (Womit) Dies geschieht, indem verschieden Programmierparadigmen eingeführt und mithilfe einer dafür geeigneten Programmiersprache praktisch ausprobiert werden. Dabei wird vergleichend auf die verschiedenen Ansätze (prozedural, objektorientiert, funktional, logisch; deklarativ und imperativ; synchron und asynchron) eingegangen, indem Algorithmen in den verschiedenen Programmiersprachen umgesetzt werden. \\n* (Wozu) Studierende sollen mithilfe von etablierten Paradigmen in der Lage sein, verschiedene Denkweisen anzunehmen und Probleme auf unterschiedliche Weisen zu lösen.\",\"content\":\"* Vergleich imperativer und deklarativer Programmierstilen und Paradigmen\\n* Objektorientierte Design Prinzipien\\n* Objektorientierte Entwurfsmuster (Strategy, Decorator, Composite, Observer, Simple Factory)\\n* Funktionen, Lambdas und Closures\\n* Funktionen höherer Ordnung\\n* Currying und Funktionskomposition\\n* Kombinatoren wie zip, map, flatMap etc.\\n* Typentheorie und Algebraische Datentypen\\n* Parametrischer Polymorphismus\\n* Ausdruck von logischen Beziehungen\\n* Fakten, Regeln und Anfragen\\n* Variablen und Atome\\n* Unifikation und Variablenbindung\\n* Resolution und Backtracking\\n* Rekursive Prädikate\\n* Listen, Listenoperationen und Pattern Matching\\n* Nebenläufige Ausführung, Threads und Thread-Sicherheit\\n* Race Conditions und Dead Locks\\n* Synchroniksationsmechanismen\\n* Koroutinen, Aktoren und Flows\\n* Synchrone und asynchrone Programmiermodelle\",\"teachingAndLearningMethods\":\"* Vorlesung mit interaktiven Phasen, Präsentationen und Live-Coding\\n* Übung\\n* Praktikum\\n* Selbststudium mit bereitgestellten Screencasts, einem umfassenden Skript sowie Fachliteratur\\n\\n4 SWS: 2 SWS Vorlesung + 1 SWS Übung + 1 SWS Praktikum\",\"recommendedReading\":\"* Skript von Prof. Dr. Erich Ehses: www.gm.fh-koeln.de/ehses/paradigmen/\\n* Kohls, C., Dobrynin, A. (2022). Programmieren lernen mit Kotlin (Auflage 2). München: Hanser Verlag.\\n* Soshin, A. (2022). Kotlin Design Patterns and Best Practices - Second Edition. Packt Publishing.\\n* Gamma, E., Helm, R., Johnson, R., & Vlissides, J. (2015). Design patterns: Entwurfsmuster als Elemente wiederverwendbarer\\n* Freeman, E., Robson, E. (2015). Entwurfsmuster von Kopf bis Fuß. O’Reilly.\\n* Vermeulen, M., Bjarnason, R., Chiusano P (2021). Functional Programming in Kotlin. Manning Publications.\\n* W.F. Clocksin, C.S. Mellish (2003). Programming in Prolog. Springer Verlag.\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"* (WHAT)\\n* (HOW)\\n* (WHY)\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  def specializationModule = Json.parse(
    "{\"metadata\":{\"id\":\"5818f43b-9dfb-4ea8-b593-4685c33b0503\",\"title\":\"Visualisierung\",\"abbrev\":\"VI\",\"kind\":{\"id\":\"module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"ects\":{\"value\":6,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de_en\",\"deLabel\":\"Deutsch und Englisch\",\"enLabel\":\"german and english\"},\"duration\":1,\"season\":{\"id\":\"ss\",\"deLabel\":\"Sommersemester\",\"enLabel\":\"summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"fni\",\"lastname\":\"Niebling\",\"firstname\":\"Florian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"FN\",\"campusId\":\"fnieblin\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"fni\",\"lastname\":\"Niebling\",\"firstname\":\"Florian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"FN\",\"campusId\":\"fnieblin\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"presentation\",\"deLabel\":\"Präsentation\",\"enLabel\":\"--\"},\"percentage\":30,\"precondition\":[]},{\"method\":{\"id\":\"presentation\",\"deLabel\":\"Präsentation\",\"enLabel\":\"--\"},\"percentage\":30,\"precondition\":[]},{\"method\":{\"id\":\"presentation\",\"deLabel\":\"Präsentation\",\"enLabel\":\"--\"},\"percentage\":20,\"precondition\":[]},{\"method\":{\"id\":\"project-documentation\",\"deLabel\":\"Projektdokumentation\",\"enLabel\":\"--\"},\"percentage\":20,\"precondition\":[]}],\"optional\":[]},\"workload\":{\"lecture\":18,\"seminar\":18,\"practical\":0,\"exercise\":18,\"projectSupervision\":18,\"projectWork\":18,\"selfStudy\":90,\"total\":180},\"prerequisites\":{\"recommended\":{\"text\":\"Kenntnisse in HTML\",\"modules\":[{\"id\":\"14cd13b2-5672-437e-bdf8-d92c63d10ece\",\"title\":\"Web Architekturen\",\"abbrev\":\"WA\"}],\"pos\":[]}},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_mim4\",\"version\":4,\"program\":\"inf_mim\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2027-02-28\"},\"specialization\":{\"id\":\"inf_mim4_vc\",\"label\":\"Visual Computing\",\"po\":\"inf_mim4\"},\"recommendedSemester\":[2]}],\"optional\":[]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"* Die Studierenden sollen in die Lage versetzt werden, abstrakte, vorwiegend numerische Datenbestände in 2-und 3-dimensionalen Repräsentationen zu visualisieren und mit interaktiven Methoden zu untersuchen, um Strukturen aufzudecken, Hypothesen abzuleiten und zu verifizieren sowie Ergebnisse zu kommunizieren.\\n* Die Studierenden sind in der Lage, die aus modernen Simulations- und Messmethoden resultierenden umfangreicheren Datenvolumina durch Visualisierungsverfahren einer Analyse zuzuführen. Dies wird sowohl anhand von theoretischen Grundlagen, der Analyse und Präsentation aktueller Forschungsergebnisse als auch der Verifikation der erworbenen Kenntnisse an eigenen Visualisierungen vermittelt.\\n* Die Studierenden sind fähig, Problemstellungen grundlagenbasiert, systemanalytisch und multiperspektivisch zu analysieren, zu formulieren, zu formalisieren und durch geeignete Visualisierungen zu lösen sowie diese Lösungen kritisch zu evaluieren.\\n* Anhand eigener Recherche vertiefen die Studierenden ihre Fähigkeit, sich eigenständig in neue Themenbereiche einzuarbeiten, sowie Problemstellungen, Technologien und wissenschaftliche Erkenntnisse im Bereich der Visualisierung in ihre Projekte einzubeziehen und für eine effektive Lösung aktueller Fragestellungen anzuwenden. Dafür bereiten sie wissenschaftliche Arbeiten für unterschiedliche Zielgruppen auf und präsentieren diese fundiert und überzeugend. Das erworbende Wissen wird in einer eigenen interaktiven Visualisierung angewandt und gefestigt.\\n* Die Studierenden lernen ihre und andere Visualisierung zu verstehen, zu bewerten und angemessen in eigene wissenschaftliche Arbeiten einfließen zu lassen.\\n* Das erworbene Können kann in verschiedensten Bereichen eingesetzt werden, um als Datenanalyst, in der Qualitätskontrolle oder Informationsvisualisierung tätg zu werden.\",\"content\":\"Grundlagen der Visualisierung und Exploration mehrdimensionaler Daten, aktuelle Visualisierungsverfahren und Interaktionsverfahren. Darüber hinaus werden Grundlagen der statistischen Datenanalyse und der 3D-Computergrafik einbezogen. Im speziellen, aber nicht ausschließlich, werden folgende Themen behandelt:\\n\\n* Design Prinzipien\\n* Daten Modelle\\n* Visuelle Parameter\\n* Interaktion\\n* Netzwerke\\n* Prozesse\\n* Graphen\\n* Hochdimensionale Daten\\n* Textvisualisierung\\n* Maps\\n* Wahrnehmung\\n* Farbe\\n* Kognition\\n* Story Telling\",\"teachingAndLearningMethods\":\"* Beamergestützte Vorlesung\\n* Beamergestützte Seminarvorträge\\n* Kombinierte Workshops aus beamergestütztem Vortrag und praktischer Übung am Rechner\\n* Projekt in Kleingruppen, um die erlernten Methoden und Techniken einzuüben und zu vertiefen (Rechnerlabor)\",\"recommendedReading\":\"* Tufte, E.R., The Visual Display of Quantitative Information, Cheshire,CT, Graphics Press 1983, und Envisioning Information, Cheshire,CT, Graphics Press 1994\\n* Murray, S.: Interactive Data Visualization for the Web, O’Reilly\\n* Meirelles, I.: Design for Information, Rockport\\n* Berger,W., Grob,H.L.: Präsentieren und Visualisieren -mit und ohne Multimedia, dtv 2002\\n* Schumann,H., Müller,W.; Visualisierung -Grundlagen und allgemeine Methoden; Springer 2000, ISBN 3-540-64944-1\\n* Data-driven Documents D3, d3js.org\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  def ppUpdate = Json.parse(
    "{\"metadata\":{\"id\":\"e37c5af9-6076-4f15-8c8b-d206b7091bc0\",\"title\":\"Paradigmen der Programmierung\",\"abbrev\":\"PP\",\"kind\":{\"id\":\"module\",\"deLabel\":\"Modul\",\"enLabel\":\"Module\"},\"ects\":{\"value\":5,\"contributionsToFocusAreas\":[]},\"language\":{\"id\":\"de\",\"deLabel\":\"Deutsch\",\"enLabel\":\"german\"},\"duration\":1,\"season\":{\"id\":\"ws_ss\",\"deLabel\":\"Winter- und Sommersemester\",\"enLabel\":\"winter and summer term\"},\"responsibilities\":{\"moduleManagement\":[{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}],\"lecturers\":[{\"id\":\"ado\",\"lastname\":\"Dobrynin\",\"firstname\":\"Alexander\",\"title\":\"M.Sc.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"AD\",\"campusId\":\"adobryni\",\"status\":\"active\",\"kind\":\"person\"},{\"id\":\"cko\",\"lastname\":\"Kohls\",\"firstname\":\"Christian\",\"title\":\"Prof. Dr.\",\"faculties\":[{\"id\":\"f10\",\"deLabel\":\"Fakultät für Informatik und Ingenieurwissenschaften\",\"enLabel\":\"Faculty of Computer Science and Engineering Science\"}],\"abbreviation\":\"CK\",\"campusId\":\"ckohls\",\"status\":\"active\",\"kind\":\"person\"}]},\"assessmentMethods\":{\"mandatory\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[{\"id\":\"practical\",\"deLabel\":\"Praktikum\",\"enLabel\":\"--\"}]}],\"optional\":[{\"method\":{\"id\":\"written-exam\",\"deLabel\":\"Klausurarbeiten\",\"enLabel\":\"--\"},\"precondition\":[]}]},\"workload\":{\"lecture\":36,\"seminar\":0,\"practical\":18,\"exercise\":18,\"projectSupervision\":0,\"projectWork\":0,\"selfStudy\":78,\"total\":150},\"prerequisites\":{\"recommended\":{\"text\":\"Grundlagen der Programmierung, Objektorientierte Programmierung\",\"modules\":[{\"id\":\"dca56fa6-1952-4b47-bf60-3dcb32e86ada\",\"title\":\"Algorithmen und Programmierung 1\",\"abbrev\":\"AP1\"},{\"id\":\"f1fd21a9-ab5c-40b0-ab09-3dff35e86a72\",\"title\":\"Algorithmen und Programmierung 2\",\"abbrev\":\"AP2\"}],\"pos\":[]}},\"status\":{\"id\":\"active\",\"deLabel\":\"Aktiv\",\"enLabel\":\"active\"},\"location\":{\"id\":\"gm\",\"deLabel\":\"Gummersbach\",\"enLabel\":\"Gummersbach\"},\"pos\":{\"mandatory\":[{\"po\":{\"id\":\"inf_inf1\",\"version\":1,\"program\":\"inf_inf\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2025-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf1_flex\",\"version\":1,\"program\":\"inf_inf_flex\",\"dateFrom\":\"2013-09-01\",\"dateTo\":\"2026-08-31\"},\"recommendedSemester\":[3]},{\"po\":{\"id\":\"inf_inf2\",\"version\":2,\"program\":\"inf_inf\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"recommendedSemester\":[4]}],\"optional\":[{\"po\":{\"id\":\"inf_itm1\",\"version\":1,\"program\":\"inf_itm\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_itm2\",\"version\":2,\"program\":\"inf_itm\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aacd9661-dba7-40e5-b98d-4e7019e18365\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi4\",\"version\":4,\"program\":\"inf_wi\",\"dateFrom\":\"2017-09-01\",\"dateTo\":\"2025-08-31\"},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_wi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3,4]},{\"po\":{\"id\":\"inf_mi5\",\"version\":5,\"program\":\"inf_wi\",\"dateFrom\":\"2021-09-01\",\"dateTo\":null},\"instanceOf\":{\"id\":\"aac6c7e4-29f3-402a-b0a1-946404943031\",\"title\":\"Wahlspezialisierung\",\"abbrev\":\"WASP\"},\"partOfCatalog\":false,\"recommendedSemester\":[3]}]},\"competences\":[],\"globalCriteria\":[],\"taughtWith\":[]},\"deContent\":{\"learningOutcome\":\"* (Was) Die Studierenden sollen unterschiedliche Programmierparadigmen verstehen und anwenden können. Weiterhin sollen sie die Angemessenheit der verschiedenen Programmierparadigmen für eine Aufgabenstellung einordnen und bewerten können. \\n* (Womit) Dies geschieht, indem verschieden Programmierparadigmen eingeführt und mithilfe einer dafür geeigneten Programmiersprache praktisch ausprobiert werden. Dabei wird vergleichend auf die verschiedenen Ansätze (prozedural, objektorientiert, funktional, logisch; deklarativ und imperativ; synchron und asynchron) eingegangen, indem Algorithmen in den verschiedenen Programmiersprachen umgesetzt werden. \\n* (Wozu) Studierende sollen mithilfe von etablierten Paradigmen in der Lage sein, verschiedene Denkweisen anzunehmen und Probleme auf unterschiedliche Weisen zu lösen.\",\"content\":\"* Vergleich imperativer und deklarativer Programmierstilen und Paradigmen\\n* Objektorientierte Design Prinzipien\\n* Objektorientierte Entwurfsmuster (Strategy, Decorator, Composite, Observer, Simple Factory)\\n* Funktionen, Lambdas und Closures\\n* Funktionen höherer Ordnung\\n* Currying und Funktionskomposition\\n* Kombinatoren wie zip, map, flatMap etc.\\n* Typentheorie und Algebraische Datentypen\\n* Parametrischer Polymorphismus\\n* Ausdruck von logischen Beziehungen\\n* Fakten, Regeln und Anfragen\\n* Variablen und Atome\\n* Unifikation und Variablenbindung\\n* Resolution und Backtracking\\n* Rekursive Prädikate\\n* Listen, Listenoperationen und Pattern Matching\\n* Nebenläufige Ausführung, Threads und Thread-Sicherheit\\n* Race Conditions und Dead Locks\\n* Synchroniksationsmechanismen\\n* Koroutinen, Aktoren und Flows\\n* Synchrone und asynchrone Programmiermodelle\",\"teachingAndLearningMethods\":\"* Vorlesung mit interaktiven Phasen, Präsentationen und Live-Coding\\n* Übung\\n* Praktikum\\n* Selbststudium mit bereitgestellten Screencasts, einem umfassenden Skript sowie Fachliteratur\\n\\n4 SWS: 2 SWS Vorlesung + 1 SWS Übung + 1 SWS Praktikum\",\"recommendedReading\":\"* Skript von Prof. Dr. Erich Ehses: www.gm.fh-koeln.de/ehses/paradigmen/\\n* Kohls, C., Dobrynin, A. (2022). Programmieren lernen mit Kotlin (Auflage 2). München: Hanser Verlag.\\n* Soshin, A. (2022). Kotlin Design Patterns and Best Practices - Second Edition. Packt Publishing.\\n* Gamma, E., Helm, R., Johnson, R., & Vlissides, J. (2015). Design patterns: Entwurfsmuster als Elemente wiederverwendbarer\\n* Freeman, E., Robson, E. (2015). Entwurfsmuster von Kopf bis Fuß. O’Reilly.\\n* Vermeulen, M., Bjarnason, R., Chiusano P (2021). Functional Programming in Kotlin. Manning Publications.\\n* W.F. Clocksin, C.S. Mellish (2003). Programming in Prolog. Springer Verlag.\",\"particularities\":\"\"},\"enContent\":{\"learningOutcome\":\"* (WHAT)\\n* (HOW)\\n* (WHY)\",\"content\":\"\",\"teachingAndLearningMethods\":\"\",\"recommendedReading\":\"\",\"particularities\":\"\"}}"
  )

  actor.createOrUpdateModule(module)
  actor.createOrUpdateModule(module)
  actor.createOrUpdateModule(genericModule)
  actor.createOrUpdateModule(childModule)
  actor.createOrUpdateModule(parentModule)
  actor.createOrUpdateModule(specializationModule)

//  private val ctx: ExecutionContext =
//    ExecutionContext.fromExecutor(Executors.newSingleThreadExecutor())
//
//  private val stopConsumer = new AtomicBoolean(false)
//
//  private val consumer = new KafkaConsumer[String, String](
//    buildProperties,
//    new StringDeserializer,
//    new StringDeserializer
//  )
//
//  consumer.subscribe(topics.asJavaCollection)
//
//  Future {
//    while (!stopConsumer.get()) {
//      consumer
//        .poll(pollInterval)
//        .asScala
//        .foreach { record =>
//          logger.info(record.toString)
//          handleRecord(record)
//        }
//    }
//    logger.info("stop polling")
//  }(ctx)
//    .andThen(_ => consumer.close())(ctx)
//    .andThen {
//      case Success(_) =>
//        logger.info("finished")
//      case Failure(e) =>
//        logger.error("failed", e)
//    }(ctx)
//
//  coordinatedShutdown.addTask(
//    CoordinatedShutdown.PhaseServiceStop,
//    "Consumer-stop"
//  ) { () =>
//    logger.info("Shutdown-task[Consumer-stop] starts.")
//    stopConsumer.set(true)
//    Future { Done }(ctx).andThen {
//      case Success(_) =>
//        logger.info("Shutdown-task[Consumer-stop] succeed.")
//      case Failure(e) =>
//        logger.error("Shutdown-task[Consumer-stop] fails.", e)
//    }(ctx)
//  }

  private def handleRecord(r: ConsumerRecord[String, String]): Unit =
    r.topic() match
      case "module-created" | "module-updated" =>
        actor.createOrUpdateModule(Json.parse(r.value()))
      case other =>
        logger.info(s"unknown topic: $other")

  private def buildProperties: Properties = {
    val properties = new Properties
    properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, serverUrl)
    properties.put(ConsumerConfig.GROUP_ID_CONFIG, groupId)
    properties
  }
}
